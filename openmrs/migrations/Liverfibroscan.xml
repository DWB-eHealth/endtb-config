<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

    <changeSet id="ENDTB-201807111308" author="Sudhamsh">
        <sql>
            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "Liver fibroscan", "Liver fibroscan", 'Coded','Misc', FALSE);
            set @concept1_id = @concept_id;
            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "Liver ultrasound nodules", "Liver ultrasound nodules", 'Coded','Misc', FALSE);
            set @concept2_id = @concept_id;
            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "Liver ultrasound ascites", "Liver ultrasound ascites", 'Coded','Misc', FALSE);
            set @concept3_id = @concept_id;
            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "Gastroscopy", "Gastroscopy", 'Coded','Misc', FALSE);
            set @concept4_id = @concept_id;
            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "Liver fibroscan and ultrasound for hepatitis", "Liver fibroscan and ultrasound for hepatitis", 'N/A','Misc', TRUE);

            call add_concept_set_members (@concept_id,@concept1_id,1);
            call add_concept_set_members (@concept_id,@concept2_id,2);
            call add_concept_set_members (@concept_id,@concept3_id,3);
            call add_concept_set_members (@concept_id,@concept4_id,4);

            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "F0-F1: 2.5-7.0", "F0-F1: 2.5-7.0", 'N/A','Misc', FALSE);
            set @answerconcept1_id = @concept_id;
            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "F2: 7.1- 9.4", "F2: 7.1- 9.4", 'N/A','Misc', FALSE);
            set @answerconcept2_id = @concept_id;
            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "F2: 9.5- 14.5", "F2: 9.5- 14.5", 'N/A','Misc', FALSE);
            set @answerconcept3_id = @concept_id;
            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "F4: > 14.5", "F4: > 14.5", 'N/A','Misc', FALSE);
            set @answerconcept4_id = @concept_id;

            call add_concept_answer (@concept1_id,@answerconcept1_id,1);
            call add_concept_answer (@concept1_id,@answerconcept2_id,2);
            call add_concept_answer (@concept1_id,@answerconcept3_id,3);
            call add_concept_answer (@concept1_id,@answerconcept4_id,4);

            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "No nodules", "No nodules",  'N/A','Misc', FALSE);
            set @answer1concept_id = @concept_id;
            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "One nodule &lt; 2 cm", "One nodule &lt; 2 cm",  'N/A','Misc', FALSE);
            set @answer2concept_id = @concept_id;
            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "One nodule > 2 cm", "One nodule > 2 cm",  'N/A','Misc', FALSE);
            set @answer3concept_id = @concept_id;
            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "More than 1 nodule , maximum size less than 2 cm", "More than 1 nodule , maximum size less than 2 cm",  'N/A','Misc', FALSE);
            set @answer4concept_id = @concept_id;
            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "More than 1 nodule, maximum size more than 2 cm", "More than 1 nodule, maximum size more than 2 cm",  'N/A','Misc', FALSE);
            set @answer5concept_id = @concept_id;

            call add_concept_answer (@concept2_id,@answer1concept_id,1);
            call add_concept_answer (@concept2_id,@answer2concept_id,2);
            call add_concept_answer (@concept2_id,@answer3concept_id,3);
            call add_concept_answer (@concept2_id,@answer4concept_id,4);
            call add_concept_answer (@concept2_id,@answer5concept_id,5);

            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "No ascites", "No ascites", 'N/A','Misc', FALSE);
            set @answerconcept1_id = @concept_id;
            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "Ascites", "Ascites", 'N/A','Misc', FALSE);
            set @answerconcept2_id = @concept_id;

            call add_concept_answer (@concept3_id,@answerconcept1_id,1);
            call add_concept_answer (@concept3_id,@answerconcept2_id,2);

            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "No varices", "No varices",  'N/A','Misc', FALSE);
            set @answerconcept1_id = @concept_id;
            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "Varices grade 1", "Varices grade 1",  'N/A','Misc', FALSE);
            set @answerconcept2_id = @concept_id;
            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "Varices grade 2", "Varices grade 2",  'N/A','Misc', FALSE);
            set @answerconcept3_id = @concept_id;
            call add_concept(@concept_id, @concept_name_short_id, @concept_name_full_id, "Varices grade 2 with red spots", "Varices grade 2 with red spots",  'N/A','Misc', FALSE);
            set @answerconcept4_id = @concept_id;


            call add_concept_answer (@concept4_id,@answerconcept1_id,1);
            call add_concept_answer (@concept4_id,@answerconcept2_id,2);
            call add_concept_answer (@concept4_id,@answerconcept3_id,3);
            call add_concept_answer (@concept4_id,@answerconcept4_id,4);

            select max(sort_weight) into @weight from concept_set where concept_set = (select concept_id from concept_view where concept_full_name = 'Xray Template');

            select concept_id into @member1_concept_id from concept_view where concept_full_name = 'Liver fibroscan and ultrasound for hepatitis';
            select concept_id into @concept_id from concept_view where concept_full_name = 'Xray Template';
            select concept_id into @member1_concept_id from concept_view where concept_full_name = 'Liver fibroscan and ultrasound for hepatitis';

            call add_concept_set_members (@concept_id, @member1_concept_id, @weight+1);
        </sql>
    </changeSet>
</databaseChangeLog>
